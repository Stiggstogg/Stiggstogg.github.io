var wt=Object.defineProperty;var mt=(i,t,e)=>t in i?wt(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var u=(i,t,e)=>(mt(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const h of n)if(h.type==="childList")for(const r of h.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(n){const h={};return n.integrity&&(h.integrity=n.integrity),n.referrerPolicy&&(h.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?h.credentials="include":n.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(n){if(n.ep)return;n.ep=!0;const h=e(n);fetch(n.href,h)}})();/**
 * @preserve
 * Kontra.js v9.0.0
 */let I=()=>{},yt="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);";function rt(i,t){let e=t.parentNode;if(i.setAttribute("data-kontra",""),e){let s=e.querySelector("[data-kontra]:last-of-type")||t;e.insertBefore(i,s.nextSibling)}else document.body.appendChild(i)}function ft(i,t){let e=i.indexOf(t);if(e!=-1)return i.splice(e,1),!0}let F={};function P(i,t){F[i]=F[i]||[],F[i].push(t)}function St(i,t){F[i]=(F[i]||[]).filter(e=>e!=t)}function R(i,...t){(F[i]||[]).map(e=>e(...t))}let O,z,ot={get(i,t){return t=="_proxy"?!0:I}};function pt(){return O}function M(){return z}function kt(i,{contextless:t=!1}={}){if(O=document.getElementById(i)||i||document.querySelector("canvas"),t&&(O=O||new Proxy({},ot)),!O)throw Error("You must provide a canvas element for the game");return z=O.getContext("2d")||new Proxy({},ot),z.imageSmoothingEnabled=!1,R("init"),{canvas:O,context:z}}function Ct(i,t){let e=Math.sin(t),s=Math.cos(t);return{x:i.x*s-i.y*e,y:i.x*e+i.y*s}}function V(i,t,e){return Math.min(Math.max(i,e),t)}function At(i,t){return[i,t]=[i,t].map(e=>gt(e)),i.x<t.x+t.width&&i.x+i.width>t.x&&i.y<t.y+t.height&&i.y+i.height>t.y}function gt(i){let{x:t=0,y:e=0,width:s,height:n}=i.world||i;return i.mapwidth&&(s=i.mapwidth,n=i.mapheight),i.anchor&&(t-=s*i.anchor.x,e-=n*i.anchor.y),s<0&&(t+=s,s*=-1),n<0&&(e+=n,n*=-1),{x:t,y:e,width:s,height:n}}class b{constructor(t=0,e=0,s={}){t.x!=null?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),s._c&&(this.clamp(s._a,s._b,s._d,s._e),this.x=t,this.y=e)}set(t){this.x=t.x,this.y=t.y}add(t){return new b(this.x+t.x,this.y+t.y,this)}subtract(t){return new b(this.x-t.x,this.y-t.y,this)}scale(t){return new b(this.x*t,this.y*t)}normalize(t=this.length()||1){return new b(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,e,s,n){this._c=!0,this._a=t,this._b=e,this._d=s,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?V(this._a,this._d,t):t}set y(t){this._y=this._c?V(this._b,this._e,t):t}}function Q(){return new b(...arguments)}class Ht{constructor(t){return this.init(t)}init(t={}){this.position=Q(),this.velocity=Q(),this.acceleration=Q(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let s=this.velocity;t&&(s=s.scale(t)),this.position=this.position.add(s),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}class tt extends Ht{init({width:t=0,height:e=0,context:s=M(),render:n=this.draw,update:h=this.advance,children:r=[],anchor:o={x:0,y:0},opacity:g=1,rotation:l=0,scaleX:a=1,scaleY:y=1,...d}={}){this._c=[],super.init({width:t,height:e,context:s,anchor:o,opacity:g,rotation:l,scaleX:a,scaleY:y,...d}),this._di=!0,this._uw(),this.addChild(r),this._rf=n,this._uf=h,P("init",()=>{this.context??(this.context=M())})}update(t){this._uf(t),this.children.map(e=>e.update&&e.update(t))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),(this.scaleX!=1||this.scaleY!=1)&&t.scale(this.scaleX,this.scaleY);let e=-this.width*this.anchor.x,s=-this.height*this.anchor.y;(e||s)&&t.translate(e,s),this.context.globalAlpha=this.opacity,this._rf(),(e||s)&&t.translate(-e,-s),this.children.map(h=>h.render&&h.render()),t.restore()}draw(){}_pc(){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:s=1,_wr:n=0,_wsx:h=1,_wsy:r=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=s*this.opacity,this._wsx=h*this.scaleX,this._wsy=r*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*r,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=n+this.rotation;let{x:o,y:g}=Ct({x:this._wx,y:this._wy},n);this._wx=o,this._wy=g,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map(e=>{this.children.push(e),e.parent=this,e._pc=e._pc||I,e._pc()})}removeChild(...t){t.flat().map(e=>{ft(this.children,e)&&(e.parent=null,e._pc())})}get opacity(){return this._opa}set opacity(t){this._opa=V(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,e=t){this.scaleX=t,this.scaleY=e}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}let Lt=/(\d+)(\w+)/;function Mt(i){if(!i)return{computed:0};let t=i.match(Lt),e=+t[1],s=t[2];return{size:e,unit:s,computed:e}}class Tt extends tt{init({text:t="",textAlign:e="",lineHeight:s=1,font:n=(r=>(r=M())==null?void 0:r.font)(),...h}={}){t=""+t,super.init({text:t,textAlign:e,lineHeight:s,font:n,...h}),this.context&&this._p(),P("init",()=>{this.font??(this.font=M().font),this._p()})}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=Mt(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context,e=[this.text];if(t.font=this.font,e=this.text.split(`
`),this._fw&&e.map(s=>{let n=s.split(" "),h=n.shift(),r=h;n.map(o=>{r+=" "+o,t.measureText(r).width>this._fw&&(this._s.push(h),r=o),h=r}),this._s.push(r)}),!this._s.length&&this.text.includes(`
`)){let s=0;e.map(n=>{this._s.push(n),s=Math.max(s,t.measureText(n).width)}),this._w=this._fw||s}this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=0,e=this.textAlign,s=this.context;e=this.textAlign||(s.canvas.dir=="rtl"?"right":"left"),t=e=="right"?this.width:e=="center"?this.width/2|0:0,this._s.map((n,h)=>{s.textBaseline="top",s.textAlign=e,s.fillStyle=this.color,s.font=this.font,this.strokeColor&&(s.strokeStyle=this.strokeColor,s.lineWidth=this.lineWidth??1,s.strokeText(n,t,this._fs*this.lineHeight*h)),s.fillText(n,t,this._fs*this.lineHeight*h)})}}function S(){return new Tt(...arguments)}let B=new WeakMap,lt={},et={},_t={0:"left",1:"middle",2:"right"};function Wt(i,t){let{x:e,y:s,width:n,height:h}=gt(i);do e-=i.sx||0,s-=i.sy||0;while(i=i.parent);let r=t.x-Math.max(e,Math.min(t.x,e+n)),o=t.y-Math.max(s,Math.min(t.y,s+h));return r*r+o*o<t.radius*t.radius}function Et(i){let t=i._lf.length?i._lf:i._cf;for(let e=t.length-1;e>=0;e--){let s=t[e];if(s.collidesWithPointer?s.collidesWithPointer(i):Wt(s,i))return s}}function k(i,t){return parseFloat(i.getPropertyValue(t))||0}function Ot(i){let{canvas:t,_s:e}=i,s=t.getBoundingClientRect(),n=e.transform!="none"?e.transform.replace("matrix(","").split(","):[1,1,1,1],h=parseFloat(n[0]),r=parseFloat(n[3]),o=(k(e,"border-left-width")+k(e,"border-right-width"))*h,g=(k(e,"border-top-width")+k(e,"border-bottom-width"))*r,l=(k(e,"padding-left")+k(e,"padding-right"))*h,a=(k(e,"padding-top")+k(e,"padding-bottom"))*r;return{scaleX:(s.width-o-l)/t.width,scaleY:(s.height-g-a)/t.height,offsetX:s.left+(k(e,"border-left-width")+k(e,"padding-left"))*h,offsetY:s.top+(k(e,"border-top-width")+k(e,"padding-top"))*r}}function at(i){let t=i.button!=null?_t[i.button]:"left";et[t]=!0,it(i,"onDown")}function Z(i){let t=i.button!=null?_t[i.button]:"left";et[t]=!1,it(i,"onUp")}function ct(i){it(i,"onOver")}function Yt(i){let t=B.get(i.target);t._oo=null,et={}}function dt(i,t,e){let s=Et(i);s&&s[t]&&s[t](e),lt[t]&&lt[t](e,s),t=="onOver"&&(s!=i._oo&&i._oo&&i._oo.onOut&&i._oo.onOut(e),i._oo=s)}function it(i,t){i.preventDefault();let e=i.target,s=B.get(e),{scaleX:n,scaleY:h,offsetX:r,offsetY:o}=Ot(s);i.type.includes("touch")?(Array.from(i.touches).map(({clientX:l,clientY:a,identifier:y})=>{let d=s.touches[y];d||(d=s.touches[y]={start:{x:(l-r)/n,y:(a-o)/h}},s.touches.length++),d.changed=!1}),Array.from(i.changedTouches).map(({clientX:l,clientY:a,identifier:y})=>{let d=s.touches[y];d.changed=!0,d.x=s.x=(l-r)/n,d.y=s.y=(a-o)/h,dt(s,t,i),R("touchChanged",i,s.touches),t=="onUp"&&(delete s.touches[y],s.touches.length--,s.touches.length||R("touchEnd"))})):(s.x=(i.clientX-r)/n,s.y=(i.clientY-o)/h,dt(s,t,i))}function Xt({radius:i=5,canvas:t=pt()}={}){let e=B.get(t);if(!e){let s=window.getComputedStyle(t);e={x:0,y:0,radius:i,touches:{length:0},canvas:t,_cf:[],_lf:[],_o:[],_oo:null,_s:s},B.set(t,e)}return t.addEventListener("mousedown",at),t.addEventListener("touchstart",at),t.addEventListener("mouseup",Z),t.addEventListener("touchend",Z),t.addEventListener("touchcancel",Z),t.addEventListener("blur",Yt),t.addEventListener("mousemove",ct),t.addEventListener("touchmove",ct),e._t||(e._t=!0,P("tick",()=>{e._lf.length=0,e._cf.map(s=>{e._lf.push(s)}),e._cf.length=0})),e}function st(...i){i.flat().map(t=>{let e=t.context?t.context.canvas:pt(),s=B.get(e);if(!s)throw new ReferenceError("Pointer events not initialized for the objects canvas");t._r||(t._r=t.render,t.render=function(){s._cf.push(this),this._r()},s._o.push(t))})}function bt(i){let t=i.canvas;i.clearRect(0,0,t.width,t.height)}function vt({fps:i=60,clearCanvas:t=!0,update:e=I,render:s,context:n=M(),blur:h=!1}={}){if(!s)throw Error("You must provide a render() function");let r=0,o=1e3/i,g=1/i,l=t?bt:I,a,y,d,x,m,A=!0;h||(window.addEventListener("focus",()=>{A=!0}),window.addEventListener("blur",()=>{A=!1})),P("init",()=>{m.context??(m.context=M())});function H(){if(y=requestAnimationFrame(H),!!A&&(d=performance.now(),x=d-a,a=d,!(x>1e3))){for(R("tick"),r+=x;r>=o;)m.update(g),r-=o;l(m.context),m.render()}}return m={update:e,render:s,isStopped:!0,context:n,start(){a=performance.now(),this.isStopped=!1,requestAnimationFrame(H)},stop(){this.isStopped=!0,cancelAnimationFrame(y)},_frame:H,set _last(c){a=c}},m}let Ft={set(i,t,e){return t.startsWith("_")||(i._d=!0),Reflect.set(i,t,e)}},ut={start(i){return i?1:0},center(){return .5},end(i){return i?0:1}};class Pt extends tt{init({flow:t="column",align:e="start",justify:s="start",colGap:n=0,rowGap:h=0,numCols:r=1,dir:o="",breakpoints:g=[],...l}={}){return super.init({flow:t,align:e,justify:s,colGap:n,rowGap:h,numCols:r,dir:o,breakpoints:g,...l}),this._p(),new Proxy(this,Ft)}addChild(t){this._d=!0,super.addChild(t)}removeChild(t){this._d=!0,super.removeChild(t)}render(){this._d&&this._p(),super.render()}destroy(){this.children.map(t=>t.destroy&&t.destroy())}_p(){this._d=!1,this.breakpoints.map(c=>{c.metric.call(this)&&this._b!==c&&(this._b=c,c.callback.call(this))});let t=this._g=[],e=this._cw=[],s=this._rh=[],n=this.children,h=this._nc=this.flow=="column"?1:this.flow=="row"?n.length:this.numCols,r=0,o=0;for(let c=0,_;_=n[c];c++){t[r]=t[r]||[],_._p&&_._p();let{width:$,height:w}=_.world||_;s[r]=Math.max(s[r]||0,w);let C=_.colSpan||1,X=C;do e[o]=Math.max(e[o]||0,$/X),t[r][o]=_;while(o++<=h&&--C);o>=h&&(o=0,r++)}for(;o>0&&o<h;)t[r][o++]=!1;let g=t.length,l=[].concat(this.colGap),a=[].concat(this.rowGap);this._w=e.reduce((c,_)=>c+=_,0);for(let c=0;c<h-1;c++)this._w+=l[c%l.length];this._h=s.reduce((c,_)=>c+=_,0);for(let c=0;c<g-1;c++)this._h+=a[c%a.length];this._uw();let d=this.context.canvas.dir=="rtl"&&!this.dir||this.dir=="rtl";this._rtl=d,d&&(this._g=t.map(c=>c.reverse()),this._cw=e.reverse(),l=l.reverse());let x=-this.anchor.y*this.height,m=[],A=[].concat(this.justify),H=[].concat(this.align);this._g.map((c,_)=>{let $=-this.anchor.x*this.width;c.map((w,C)=>{if(w&&!m.includes(w)){m.push(w);let X=ut[w.justifySelf||A[C%A.length]](this._rtl),q=ut[w.alignSelf||H[_%H.length]](),K=w.colSpan||1,ht=e[C];if(K>1&&C+K<=this._nc)for(let L=1;L<K;L++)ht+=e[C+L]+l[(C+L)%l.length];let T=ht*X,W=s[_]*q,D=0,G=0,{width:N,height:J}=w.world||w;if(w.anchor&&(D=w.anchor.x,G=w.anchor.y),X==0)T=T+N*D;else if(X==.5){let L=D<.5?-1:D==.5?0:1;T=T+L*N*X}else T=T-N*(1-D);if(q==0)W=W+J*G;else if(q==.5){let L=G<.5?-1:G==.5?0:1;W=W+L*J*q}else W=W-J*(1-G);w.x=$+T,w.y=x+W}$+=e[C]+l[C%l.length]}),x+=s[_]+a[_%a.length]})}}function nt(){return new Pt(...arguments)}function j(i){let t=[];return i._dn?t.push(i._dn):i.children&&i.children.map(e=>{t=t.concat(j(e))}),t}class U{constructor({id:t,name:e=t,objects:s=[],context:n=M(),cullObjects:h=!0,cullFunction:r=At,sortFunction:o,...g}){this._o=[],Object.assign(this,{id:t,name:e,context:n,cullObjects:h,cullFunction:r,sortFunction:o,...g});let l=this._dn=document.createElement("section");l.tabIndex=-1,l.style=yt,l.id=t,l.setAttribute("aria-label",e);let a=this;class y extends tt{set x(x){a.sx=x-this.centerX,super.x=x}get x(){return super.x}set y(x){a.sy=x-this.centerY,super.y=x}get y(){return super.y}}this.camera=new y({context:n,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(s),this._i=()=>{this.context??(this.context=M());let d=this.context.canvas,{width:x,height:m}=d,A=x/2,H=m/2;Object.assign(this.camera,{centerX:A,centerY:H,x:A,y:H,width:x,height:m}),this._dn.isConnected||rt(this._dn,d)},this.context&&this._i(),P("init",this._i)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map(e=>{this._o.push(e),e.parent=this,j(e).map(s=>{this._dn.appendChild(s)})})}remove(...t){t.flat().map(e=>{ft(this._o,e),e.parent=null,j(e).map(s=>{rt(s,this.context)})})}show(){this.hidden=this._dn.hidden=!1;let t=this._o.find(e=>e.focus);t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}destroy(){St("init",this._i),this._dn.remove(),this._o.map(t=>t.destroy&&t.destroy())}lookAt(t){let{x:e,y:s}=t.world||t;this.camera.x=e,this.camera.y=s}update(t){this.hidden||this._o.map(e=>e.update&&e.update(t))}_rf(){let{_o:t,context:e,_sx:s,_sy:n,camera:h,sortFunction:r,cullObjects:o,cullFunction:g}=this;e.translate(s,n);let l=t;o&&(l=l.filter(a=>g(h,a))),r&&l.sort(r),l.map(a=>a.render&&a.render())}render(){if(!this.hidden){let{context:t,camera:e}=this,{x:s,y:n,centerX:h,centerY:r}=e;t.save(),this._sx=h-s,this._sy=r-n,t.translate(this._sx,this._sy),e.render(),t.restore()}}onShow(){}onHide(){}}class Dt{constructor(){u(this,"scenes");u(this,"currentScene");this.scenes=[]}init(t){this.scenes.push(...t),this.currentScene=this.scenes[0],this.currentScene.show()}start(t){this.currentScene.hide();for(let e of this.scenes)if(e.id==t){this.currentScene=e;break}this.currentScene.show()}}class Gt extends U{constructor(t){super({id:t})}onShow(){Y.start("menu")}}let f=[];f.push({font:"72px Arial",color:"white",anchor:{x:.5,y:.5},textAlign:"center"});f.push({font:"48px Arial",color:"yellow",anchor:{x:.5,y:.5},textAlign:"center"});f.push({font:"24px Arial",color:"white",anchor:{x:0,y:0},textAlign:"left"});f.push({font:"80px Arial",color:"white",anchor:{x:.5,y:.5},textAlign:"center"});f.push({font:"180px Arial",color:"white",anchor:{x:.5,y:.5},textAlign:"center"});f.push({font:"24px Arial",color:"white",anchor:{x:0,y:0},textAlign:"center"});const p={yearLength:20,gameWidth:0,gameHeight:0};class Rt extends U{constructor(t){super({id:t})}onShow(){let t=S({text:"Cathedral Master Builder",...f[0]}),e=S({text:"Start",...f[1],onDown:()=>{Y.start("game")}}),s=S({text:"Credits",...f[1],onDown:()=>{console.log("Credits pressed")}});const n=p.gameHeight*.1;let h=nt({x:p.gameWidth/2,y:n*2,anchor:{x:.5,y:0},rowGap:[n*1.5,n,n],justify:"center",children:[t,e,s]});st(e,s),this.add(h),Y.start("game")}onHide(){}update(){super.update()}render(){super.render()}}class E{constructor(t,e,s,n,h){u(this,"name");u(this,"description");u(this,"image");u(this,"compo");this.name=s,this.description=S({text:this.name,...f[2],onDown:()=>{this.click()}}),this.image=S({text:n,...f[h],onDown:()=>{this.click()}}),this.compo=nt({x:p.gameWidth*t,y:p.gameHeight*e,anchor:{x:.5,y:.5},justify:"center",children:[this.image,this.description]}),st(this.description,this.image)}click(){R("click"+this.name)}tick(){console.log("tick: "+this.name)}}class Bt extends U{constructor(e){super({id:e});u(this,"money");u(this,"stone");u(this,"iron");u(this,"bread");u(this,"tools");u(this,"places");u(this,"market");u(this,"town");u(this,"year");u(this,"progress");u(this,"tickLength");u(this,"lastTickTime");u(this,"nextTick");this.places=[]}onShow(){this.year=S({text:"1213",...f[0],x:p.gameWidth*.55,y:p.gameHeight*.1}),this.money=S({text:"🪙: 0 FRT",...f[2]}),this.stone=S({text:"🪨: 0 kg",...f[2]}),this.iron=S({text:"🧲: 0 kg",...f[2]}),this.bread=S({text:"🥖: 0 pcs",...f[2]}),this.tools=S({text:"⚒️: 0 pcs",...f[2]});let e=nt({x:p.gameWidth*.01,y:p.gameWidth*.01,anchor:{x:0,y:0},rowGap:p.gameHeight*.02,children:[this.money,this.stone,this.iron,this.bread,this.tools]});this.places.push(new E(.25,.75,"Bishop","✝️",3)),this.places.push(new E(.37,.35,"Bakery","🥖",3)),this.places.push(new E(.73,.35,"Blacksmith","⚒️",3)),this.places.push(new E(.85,.75,"Masonry","🪨",3)),this.places.push(new E(.55,.63,"Cathedral","⛪",4)),this.town=new E(.05,.85,"Town","🏘️",3),this.market=new E(.05,.55,"Market","🧺",3),this.progress=S({text:"100 %",...f[1],x:p.gameWidth*.55,y:p.gameHeight*.9}),this.progress.color="white",this.add([this.year,e,this.market.compo,this.town.compo,this.progress]);for(let s of this.places)this.add(s.compo);P("clickCathedral",()=>{console.log("Cathedral was clicked")}),this.tickLength=Math.round(p.yearLength*1e3/this.places.length),this.lastTickTime=Date.now()-this.tickLength,this.nextTick=0}onHide(){}update(){super.update(),Date.now()-this.lastTickTime>this.tickLength&&(this.lastTickTime=Date.now(),this.places[this.nextTick].tick(),this.nextTick++,this.nextTick>=this.places.length&&(this.nextTick=0,this.year.text=String(Number(this.year.text)+1)))}render(){super.render()}}class $t extends U{constructor(t){super({id:t})}onShow(){let t=S({text:"You WON!",...f[1],x:p.gameWidth/2,y:p.gameHeight/2,onDown:()=>{Y.start("menu")}});st(t),this.add(t)}onHide(){}update(){super.update()}render(){super.render()}}let{canvas:v,context:Jt}=kt();Xt();p.gameWidth=v.width;p.gameHeight=v.height;addEventListener("resize",xt);xt();const qt=new Gt("loading"),zt=new Rt("menu"),It=new Bt("game"),Ut=new $t("win");let Y=new Dt;Y.init([qt,zt,It,Ut]);let Kt=vt({update:function(){Y.currentScene.update()},render:function(){Y.currentScene.render()}});Kt.start();function xt(){let i=p.gameWidth/p.gameHeight;window.innerWidth/i>window.innerHeight?(v.style.height=String(window.innerHeight)+"px",v.style.width=String(window.innerHeight*i)+"px"):(v.style.width=String(window.innerWidth)+"px",v.style.height=String(window.innerWidth/i)+"px")}
